+ export CUDA_DEVICE_MAX_CONNECTIONS=32
+ CUDA_DEVICE_MAX_CONNECTIONS=32
+ srun -p h01 -N 2 --ntasks-per-node=8 --gres=gpu:8 --mem 256G -K -w 'g[40,42]' -c 13 ./scripts/runtime/bench_dist_attn.sh python bench_dist_attn.py
GpuFreq=control_disabled
GpuFreq=control_disabled
Sqkvs: [256, 512, 1024, 2048, 4096, 8192, 16384]
total_size: 30299652096
[rank13]:[W113 02:28:50.899285715 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 13]  using GPU 5 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank14]:[W113 02:28:50.899269424 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 14]  using GPU 6 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank15]:[W113 02:28:50.899735898 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 15]  using GPU 7 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank10]:[W113 02:28:50.970535597 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 10]  using GPU 2 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank11]:[W113 02:28:50.970447350 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 11]  using GPU 3 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank12]:[W113 02:28:50.970522701 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 12]  using GPU 4 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank9]:[W113 02:28:50.971727994 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 9]  using GPU 1 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank8]:[W113 02:28:50.973360198 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 8]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
causal=False, fob=0:
da_config: SP=(2,8),Sg=(256,256),S=(4096,4096),Nh=(1,1),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
[rank0]:[W113 02:28:50.146424627 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 0]  using GPU 0 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank1]:[W113 02:28:50.146404904 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 1]  using GPU 1 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank2]:[W113 02:28:50.146513501 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 2]  using GPU 2 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank3]:[W113 02:28:50.146396215 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 3]  using GPU 3 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank4]:[W113 02:28:50.146455486 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 4]  using GPU 4 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank5]:[W113 02:28:50.146405376 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 5]  using GPU 5 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank7]:[W113 02:28:50.146396011 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 7]  using GPU 7 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
[rank6]:[W113 02:28:50.147998803 ProcessGroupNCCL.cpp:4563] [PG ID 0 PG GUID 0 Rank 6]  using GPU 6 to perform barrier as devices used by this process are currently unknown. This can potentially cause a hang if this rank to GPU mapping is incorrect. Specify device_ids in barrier() to force use of a particular device, or call init_process_group() with a device_id.
# ring_flash_attn_func, fwd
mfu: 0.069 Tflops/s, hfu: 0.069 Tflops/s, 129.126 iter/s, 7.744e-03 s/iter, (7.556, 0.002, 0.031) sec
# orchestrated_attn_func
mfu: 1.256 Tflops/s, hfu: 1.256 Tflops/s, 2339.685 iter/s, 4.274e-04 s/iter, (28.664, 0.001, 0.002) sec
mfu: 1.37 Tflops/s, hfu: 1.37 Tflops/s, 2552.166 iter/s, 3.918e-04 s/iter, (0.108, 0.001, 0.002) sec
mfu: 2.799 Tflops/s, hfu: 2.799 Tflops/s, 5214.417 iter/s, 1.918e-04 s/iter, (4.229, 0.001, 0.001) sec
mfu: 2.219 Tflops/s, hfu: 2.219 Tflops/s, 4132.778 iter/s, 2.420e-04 s/iter, (0.097, 0.001, 0.001) sec
da_config: SP=(2,8),Sg=(512,512),S=(8192,8192),Nh=(1,1),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, fwd
mfu: 0.304 Tflops/s, hfu: 0.304 Tflops/s, 141.576 iter/s, 7.063e-03 s/iter, (0.016, 0.002, 0.028) sec
# orchestrated_attn_func
mfu: 4.393 Tflops/s, hfu: 4.393 Tflops/s, 2045.626 iter/s, 4.888e-04 s/iter, (0.104, 0.001, 0.002) sec
mfu: 6.173 Tflops/s, hfu: 6.173 Tflops/s, 2874.356 iter/s, 3.479e-04 s/iter, (0.101, 0.001, 0.001) sec
mfu: 6.932 Tflops/s, hfu: 6.932 Tflops/s, 3227.889 iter/s, 3.098e-04 s/iter, (0.102, 0.001, 0.001) sec
mfu: 8.52 Tflops/s, hfu: 8.52 Tflops/s, 3967.624 iter/s, 2.520e-04 s/iter, (2.850, 0.001, 0.001) sec
da_config: SP=(2,8),Sg=(1024,1024),S=(16384,16384),Nh=(1,1),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, fwd
mfu: 1.125 Tflops/s, hfu: 1.125 Tflops/s, 130.982 iter/s, 7.635e-03 s/iter, (0.018, 0.003, 0.031) sec
# orchestrated_attn_func
mfu: 20.339 Tflops/s, hfu: 20.339 Tflops/s, 2367.828 iter/s, 4.223e-04 s/iter, (0.103, 0.001, 0.002) sec
mfu: 24.832 Tflops/s, hfu: 24.832 Tflops/s, 2890.842 iter/s, 3.459e-04 s/iter, (0.104, 0.001, 0.001) sec
mfu: 18.591 Tflops/s, hfu: 18.591 Tflops/s, 2164.315 iter/s, 4.620e-04 s/iter, (0.098, 0.001, 0.002) sec
mfu: 49.763 Tflops/s, hfu: 49.763 Tflops/s, 5793.205 iter/s, 1.726e-04 s/iter, (0.099, 0.001, 0.001) sec
da_config: SP=(2,8),Sg=(2048,2048),S=(32768,32768),Nh=(1,1),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, fwd
mfu: 5.15 Tflops/s, hfu: 5.15 Tflops/s, 149.878 iter/s, 6.672e-03 s/iter, (0.018, 0.001, 0.027) sec
# orchestrated_attn_func
mfu: 61.658 Tflops/s, hfu: 61.658 Tflops/s, 1794.482 iter/s, 5.573e-04 s/iter, (0.101, 0.002, 0.002) sec
mfu: 67.432 Tflops/s, hfu: 67.432 Tflops/s, 1962.539 iter/s, 5.095e-04 s/iter, (0.100, 0.001, 0.002) sec
mfu: 79.388 Tflops/s, hfu: 79.388 Tflops/s, 2310.493 iter/s, 4.328e-04 s/iter, (0.098, 0.001, 0.002) sec
mfu: 78.275 Tflops/s, hfu: 78.275 Tflops/s, 2278.112 iter/s, 4.390e-04 s/iter, (2.784, 0.001, 0.002) sec
da_config: SP=(2,8),Sg=(4096,4096),S=(65536,65536),Nh=(1,1),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, fwd
mfu: 19.231 Tflops/s, hfu: 19.231 Tflops/s, 139.924 iter/s, 7.147e-03 s/iter, (0.019, 0.002, 0.029) sec
# orchestrated_attn_func
mfu: 126.314 Tflops/s, hfu: 126.314 Tflops/s, 919.057 iter/s, 1.088e-03 s/iter, (0.107, 0.001, 0.004) sec
mfu: 146.731 Tflops/s, hfu: 146.731 Tflops/s, 1067.610 iter/s, 9.367e-04 s/iter, (0.105, 0.001, 0.004) sec
mfu: 150.495 Tflops/s, hfu: 150.495 Tflops/s, 1094.993 iter/s, 9.132e-04 s/iter, (0.099, 0.001, 0.004) sec
mfu: 187.978 Tflops/s, hfu: 187.978 Tflops/s, 1367.720 iter/s, 7.311e-04 s/iter, (0.100, 0.001, 0.003) sec
da_config: SP=(2,8),Sg=(8192,8192),S=(131072,131072),Nh=(1,1),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, fwd
mfu: 71.628 Tflops/s, hfu: 71.628 Tflops/s, 130.290 iter/s, 7.675e-03 s/iter, (0.018, 0.003, 0.031) sec
# orchestrated_attn_func
mfu: 184.352 Tflops/s, hfu: 184.352 Tflops/s, 335.334 iter/s, 2.982e-03 s/iter, (0.105, 0.001, 0.012) sec
mfu: 210.015 Tflops/s, hfu: 210.015 Tflops/s, 382.014 iter/s, 2.618e-03 s/iter, (0.103, 0.001, 0.010) sec
mfu: 235.35 Tflops/s, hfu: 235.35 Tflops/s, 428.098 iter/s, 2.336e-03 s/iter, (0.101, 0.001, 0.009) sec
mfu: 295.276 Tflops/s, hfu: 295.276 Tflops/s, 537.103 iter/s, 1.862e-03 s/iter, (0.102, 0.001, 0.007) sec
da_config: SP=(2,8),Sg=(16384,16384),S=(262144,262144),Nh=(1,1),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, fwd
mfu: 226.112 Tflops/s, hfu: 226.112 Tflops/s, 102.824 iter/s, 9.725e-03 s/iter, (0.022, 0.001, 0.039) sec
# orchestrated_attn_func
mfu: 204.594 Tflops/s, hfu: 204.594 Tflops/s, 93.039 iter/s, 1.075e-02 s/iter, (0.118, 0.001, 0.043) sec
mfu: 291.323 Tflops/s, hfu: 291.323 Tflops/s, 132.478 iter/s, 7.548e-03 s/iter, (0.115, 0.001, 0.030) sec
mfu: 308.977 Tflops/s, hfu: 308.977 Tflops/s, 140.507 iter/s, 7.117e-03 s/iter, (0.113, 0.001, 0.028) sec
mfu: 338.995 Tflops/s, hfu: 338.995 Tflops/s, 154.157 iter/s, 6.487e-03 s/iter, (0.112, 0.001, 0.026) sec
da_config: SP=(2,8),Sg=(256,256),S=(4096,4096),Nh=(32,32),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, fwd
mfu: 3.467 Tflops/s, hfu: 3.467 Tflops/s, 201.809 iter/s, 4.955e-03 s/iter, (0.012, 0.001, 0.020) sec
# orchestrated_attn_func
mfu: 26.147 Tflops/s, hfu: 26.147 Tflops/s, 1521.940 iter/s, 6.571e-04 s/iter, (0.103, 0.002, 0.003) sec
mfu: 24.475 Tflops/s, hfu: 24.475 Tflops/s, 1424.647 iter/s, 7.019e-04 s/iter, (0.101, 0.001, 0.003) sec
mfu: 24.419 Tflops/s, hfu: 24.419 Tflops/s, 1421.375 iter/s, 7.035e-04 s/iter, (0.100, 0.001, 0.003) sec
mfu: 31.845 Tflops/s, hfu: 31.845 Tflops/s, 1853.609 iter/s, 5.395e-04 s/iter, (0.104, 0.001, 0.002) sec
da_config: SP=(2,8),Sg=(512,512),S=(8192,8192),Nh=(32,32),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, fwd
mfu: 11.612 Tflops/s, hfu: 11.612 Tflops/s, 168.981 iter/s, 5.918e-03 s/iter, (0.016, 0.001, 0.024) sec
# orchestrated_attn_func
mfu: 63.084 Tflops/s, hfu: 63.084 Tflops/s, 917.997 iter/s, 1.089e-03 s/iter, (0.100, 0.001, 0.004) sec
mfu: 70.651 Tflops/s, hfu: 70.651 Tflops/s, 1028.113 iter/s, 9.727e-04 s/iter, (0.106, 0.001, 0.004) sec
mfu: 54.491 Tflops/s, hfu: 54.491 Tflops/s, 792.946 iter/s, 1.261e-03 s/iter, (0.106, 0.001, 0.005) sec
mfu: 74.446 Tflops/s, hfu: 74.446 Tflops/s, 1083.330 iter/s, 9.231e-04 s/iter, (0.101, 0.001, 0.004) sec
da_config: SP=(2,8),Sg=(1024,1024),S=(16384,16384),Nh=(32,32),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, fwd
mfu: 24.388 Tflops/s, hfu: 24.388 Tflops/s, 88.724 iter/s, 1.127e-02 s/iter, (0.027, 0.001, 0.045) sec
# orchestrated_attn_func
mfu: 135.455 Tflops/s, hfu: 135.455 Tflops/s, 492.782 iter/s, 2.029e-03 s/iter, (0.104, 0.001, 0.008) sec
mfu: 137.348 Tflops/s, hfu: 137.348 Tflops/s, 499.670 iter/s, 2.001e-03 s/iter, (0.102, 0.001, 0.008) sec
mfu: 96.437 Tflops/s, hfu: 96.437 Tflops/s, 350.835 iter/s, 2.850e-03 s/iter, (0.105, 0.001, 0.011) sec
mfu: 146.121 Tflops/s, hfu: 146.121 Tflops/s, 531.587 iter/s, 1.881e-03 s/iter, (0.101, 0.001, 0.008) sec
da_config: SP=(2,8),Sg=(2048,2048),S=(32768,32768),Nh=(32,32),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, fwd
mfu: 46.229 Tflops/s, hfu: 46.229 Tflops/s, 42.045 iter/s, 2.378e-02 s/iter, (0.053, 0.002, 0.095) sec
# orchestrated_attn_func
mfu: 176.719 Tflops/s, hfu: 176.719 Tflops/s, 160.725 iter/s, 6.222e-03 s/iter, (0.113, 0.001, 0.025) sec
mfu: 187.134 Tflops/s, hfu: 187.134 Tflops/s, 170.197 iter/s, 5.876e-03 s/iter, (0.111, 0.001, 0.024) sec
mfu: 182.967 Tflops/s, hfu: 182.967 Tflops/s, 166.407 iter/s, 6.009e-03 s/iter, (0.112, 0.001, 0.024) sec
mfu: 208.403 Tflops/s, hfu: 208.403 Tflops/s, 189.541 iter/s, 5.276e-03 s/iter, (0.115, 0.001, 0.021) sec
da_config: SP=(2,8),Sg=(4096,4096),S=(65536,65536),Nh=(32,32),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, fwd
mfu: 85.926 Tflops/s, hfu: 85.926 Tflops/s, 19.537 iter/s, 5.118e-02 s/iter, (0.106, 0.001, 0.205) sec
# orchestrated_attn_func
mfu: 308.176 Tflops/s, hfu: 308.176 Tflops/s, 70.071 iter/s, 1.427e-02 s/iter, (0.130, 0.001, 0.057) sec
mfu: 318.829 Tflops/s, hfu: 318.829 Tflops/s, 72.493 iter/s, 1.379e-02 s/iter, (0.127, 0.001, 0.055) sec
mfu: 255.181 Tflops/s, hfu: 255.181 Tflops/s, 58.021 iter/s, 1.724e-02 s/iter, (0.134, 0.001, 0.069) sec
mfu: 280.266 Tflops/s, hfu: 280.266 Tflops/s, 63.725 iter/s, 1.569e-02 s/iter, (0.132, 0.001, 0.063) sec
da_config: SP=(2,8),Sg=(8192,8192),S=(131072,131072),Nh=(32,32),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, fwd
mfu: 142.063 Tflops/s, hfu: 142.063 Tflops/s, 8.075 iter/s, 1.238e-01 s/iter, (0.254, 0.003, 0.495) sec
# orchestrated_attn_func
mfu: 351.341 Tflops/s, hfu: 351.341 Tflops/s, 19.971 iter/s, 5.007e-02 s/iter, (0.206, 0.001, 0.200) sec
mfu: 368.396 Tflops/s, hfu: 368.396 Tflops/s, 20.941 iter/s, 4.775e-02 s/iter, (0.198, 0.001, 0.191) sec
mfu: 306.002 Tflops/s, hfu: 306.002 Tflops/s, 17.394 iter/s, 5.749e-02 s/iter, (0.219, 0.002, 0.230) sec
mfu: 338.952 Tflops/s, hfu: 338.952 Tflops/s, 19.267 iter/s, 5.190e-02 s/iter, (0.205, 0.001, 0.208) sec
da_config: SP=(2,8),Sg=(16384,16384),S=(262144,262144),Nh=(32,32),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, fwd
mfu: 216.033 Tflops/s, hfu: 216.033 Tflops/s, 3.070 iter/s, 3.257e-01 s/iter, (0.682, 0.003, 1.303) sec
# orchestrated_attn_func
mfu: 361.765 Tflops/s, hfu: 361.765 Tflops/s, 5.141 iter/s, 1.945e-01 s/iter, (0.513, 0.001, 0.778) sec
mfu: 370.507 Tflops/s, hfu: 370.507 Tflops/s, 5.265 iter/s, 1.899e-01 s/iter, (0.487, 0.003, 0.760) sec
mfu: 329.65 Tflops/s, hfu: 329.65 Tflops/s, 4.685 iter/s, 2.135e-01 s/iter, (0.526, 0.001, 0.854) sec
mfu: 357.374 Tflops/s, hfu: 357.374 Tflops/s, 5.079 iter/s, 1.969e-01 s/iter, (0.505, 0.003, 0.788) sec
causal=False, fob=1:
da_config: SP=(2,8),Sg=(256,256),S=(4096,4096),Nh=(1,1),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, bwd
mfu: 0.144 Tflops/s, hfu: 0.18 Tflops/s, 134.001 iter/s, 7.463e-03 s/iter, (0.017, 0.001, 0.030) sec
# orchestrated_attn_func
mfu: 1.41 Tflops/s, hfu: 1.763 Tflops/s, 1313.177 iter/s, 7.615e-04 s/iter, (0.106, 0.001, 0.003) sec
mfu: 1.577 Tflops/s, hfu: 1.971 Tflops/s, 1468.584 iter/s, 6.809e-04 s/iter, (0.103, 0.001, 0.003) sec
mfu: 4.009 Tflops/s, hfu: 5.011 Tflops/s, 3733.238 iter/s, 2.679e-04 s/iter, (0.099, 0.001, 0.001) sec
mfu: 2.937 Tflops/s, hfu: 3.671 Tflops/s, 2735.170 iter/s, 3.656e-04 s/iter, (0.098, 0.001, 0.001) sec
da_config: SP=(2,8),Sg=(512,512),S=(8192,8192),Nh=(1,1),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, bwd
mfu: 0.604 Tflops/s, hfu: 0.756 Tflops/s, 140.735 iter/s, 7.106e-03 s/iter, (0.015, 0.001, 0.028) sec
# orchestrated_attn_func
mfu: 4.385 Tflops/s, hfu: 5.482 Tflops/s, 1021.050 iter/s, 9.794e-04 s/iter, (0.101, 0.001, 0.004) sec
mfu: 4.539 Tflops/s, hfu: 5.674 Tflops/s, 1056.922 iter/s, 9.461e-04 s/iter, (0.106, 0.001, 0.004) sec
mfu: 9.657 Tflops/s, hfu: 12.071 Tflops/s, 2248.363 iter/s, 4.448e-04 s/iter, (0.101, 0.001, 0.002) sec
mfu: 9.339 Tflops/s, hfu: 11.674 Tflops/s, 2174.442 iter/s, 4.599e-04 s/iter, (0.099, 0.001, 0.002) sec
da_config: SP=(2,8),Sg=(1024,1024),S=(16384,16384),Nh=(1,1),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, bwd
mfu: 2.267 Tflops/s, hfu: 2.834 Tflops/s, 131.971 iter/s, 7.577e-03 s/iter, (0.016, 0.001, 0.030) sec
# orchestrated_attn_func
mfu: 11.633 Tflops/s, hfu: 14.542 Tflops/s, 677.143 iter/s, 1.477e-03 s/iter, (0.105, 0.001, 0.006) sec
mfu: 11.769 Tflops/s, hfu: 14.711 Tflops/s, 685.048 iter/s, 1.460e-03 s/iter, (0.103, 0.001, 0.006) sec
mfu: 38.117 Tflops/s, hfu: 47.646 Tflops/s, 2218.712 iter/s, 4.507e-04 s/iter, (0.098, 0.001, 0.002) sec
mfu: 29.021 Tflops/s, hfu: 36.276 Tflops/s, 1689.235 iter/s, 5.920e-04 s/iter, (0.097, 0.002, 0.002) sec
da_config: SP=(2,8),Sg=(2048,2048),S=(32768,32768),Nh=(1,1),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, bwd
mfu: 9.126 Tflops/s, hfu: 11.408 Tflops/s, 132.806 iter/s, 7.530e-03 s/iter, (0.018, 0.001, 0.030) sec
# orchestrated_attn_func
mfu: 27.566 Tflops/s, hfu: 34.458 Tflops/s, 401.139 iter/s, 2.493e-03 s/iter, (0.107, 0.001, 0.010) sec
mfu: 27.759 Tflops/s, hfu: 34.699 Tflops/s, 403.952 iter/s, 2.476e-03 s/iter, (0.103, 0.001, 0.010) sec
mfu: 87.772 Tflops/s, hfu: 109.714 Tflops/s, 1277.244 iter/s, 7.829e-04 s/iter, (0.099, 0.001, 0.003) sec
mfu: 67.398 Tflops/s, hfu: 84.247 Tflops/s, 980.769 iter/s, 1.020e-03 s/iter, (0.100, 0.001, 0.004) sec
da_config: SP=(2,8),Sg=(4096,4096),S=(65536,65536),Nh=(1,1),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, bwd
mfu: 41.968 Tflops/s, hfu: 52.46 Tflops/s, 152.679 iter/s, 6.550e-03 s/iter, (0.016, 0.001, 0.026) sec
# orchestrated_attn_func
mfu: 60.515 Tflops/s, hfu: 75.643 Tflops/s, 220.151 iter/s, 4.542e-03 s/iter, (0.112, 0.001, 0.018) sec
mfu: 60.36 Tflops/s, hfu: 75.45 Tflops/s, 219.587 iter/s, 4.554e-03 s/iter, (0.113, 0.001, 0.018) sec
mfu: 157.991 Tflops/s, hfu: 197.489 Tflops/s, 574.768 iter/s, 1.740e-03 s/iter, (0.101, 0.001, 0.007) sec
mfu: 132.806 Tflops/s, hfu: 166.008 Tflops/s, 483.146 iter/s, 2.070e-03 s/iter, (0.101, 0.001, 0.008) sec
da_config: SP=(2,8),Sg=(8192,8192),S=(131072,131072),Nh=(1,1),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, bwd
mfu: 111.234 Tflops/s, hfu: 139.043 Tflops/s, 101.167 iter/s, 9.885e-03 s/iter, (0.022, 0.001, 0.040) sec
# orchestrated_attn_func
mfu: 126.373 Tflops/s, hfu: 157.966 Tflops/s, 114.935 iter/s, 8.701e-03 s/iter, (0.116, 0.001, 0.035) sec
mfu: 126.221 Tflops/s, hfu: 157.776 Tflops/s, 114.797 iter/s, 8.711e-03 s/iter, (0.120, 0.001, 0.035) sec
mfu: 203.678 Tflops/s, hfu: 254.598 Tflops/s, 185.244 iter/s, 5.398e-03 s/iter, (0.112, 0.001, 0.022) sec
mfu: 200.401 Tflops/s, hfu: 250.501 Tflops/s, 182.263 iter/s, 5.487e-03 s/iter, (0.108, 0.001, 0.022) sec
da_config: SP=(2,8),Sg=(16384,16384),S=(262144,262144),Nh=(1,1),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, bwd
mfu: 199.145 Tflops/s, hfu: 248.931 Tflops/s, 45.280 iter/s, 2.208e-02 s/iter, (0.047, 0.001, 0.088) sec
# orchestrated_attn_func
mfu: 151.899 Tflops/s, hfu: 189.874 Tflops/s, 34.538 iter/s, 2.895e-02 s/iter, (0.162, 0.001, 0.116) sec
mfu: 158.57 Tflops/s, hfu: 198.212 Tflops/s, 36.055 iter/s, 2.774e-02 s/iter, (0.161, 0.001, 0.111) sec
mfu: 236.523 Tflops/s, hfu: 295.653 Tflops/s, 53.779 iter/s, 1.859e-02 s/iter, (0.136, 0.001, 0.074) sec
mfu: 220.673 Tflops/s, hfu: 275.842 Tflops/s, 50.175 iter/s, 1.993e-02 s/iter, (0.137, 0.001, 0.080) sec
da_config: SP=(2,8),Sg=(256,256),S=(4096,4096),Nh=(32,32),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, bwd
mfu: 3.683 Tflops/s, hfu: 4.603 Tflops/s, 107.182 iter/s, 9.330e-03 s/iter, (0.021, 0.001, 0.037) sec
# orchestrated_attn_func
mfu: 32.186 Tflops/s, hfu: 40.233 Tflops/s, 936.737 iter/s, 1.068e-03 s/iter, (0.100, 0.001, 0.004) sec
mfu: 31.637 Tflops/s, hfu: 39.546 Tflops/s, 920.749 iter/s, 1.086e-03 s/iter, (0.103, 0.001, 0.004) sec
da_config: SP=(2,8),Sg=(512,512),S=(8192,8192),Nh=(32,32),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, bwd
mfu: 7.762 Tflops/s, hfu: 9.703 Tflops/s, 56.478 iter/s, 1.771e-02 s/iter, (0.039, 0.001, 0.071) sec
# orchestrated_attn_func
mfu: 71.318 Tflops/s, hfu: 89.147 Tflops/s, 518.905 iter/s, 1.927e-03 s/iter, (0.104, 0.001, 0.008) sec
mfu: 68.112 Tflops/s, hfu: 85.14 Tflops/s, 495.577 iter/s, 2.018e-03 s/iter, (0.105, 0.001, 0.008) sec
da_config: SP=(2,8),Sg=(1024,1024),S=(16384,16384),Nh=(32,32),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, bwd
mfu: 15.941 Tflops/s, hfu: 19.926 Tflops/s, 28.996 iter/s, 3.449e-02 s/iter, (0.076, 0.001, 0.138) sec
# orchestrated_attn_func
mfu: 118.814 Tflops/s, hfu: 148.517 Tflops/s, 216.121 iter/s, 4.627e-03 s/iter, (0.109, 0.001, 0.019) sec
mfu: 114.775 Tflops/s, hfu: 143.469 Tflops/s, 208.775 iter/s, 4.790e-03 s/iter, (0.108, 0.001, 0.019) sec
da_config: SP=(2,8),Sg=(2048,2048),S=(32768,32768),Nh=(32,32),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, bwd
mfu: 32.27 Tflops/s, hfu: 40.337 Tflops/s, 14.675 iter/s, 6.814e-02 s/iter, (0.143, 0.001, 0.273) sec
# orchestrated_attn_func
mfu: 168.6 Tflops/s, hfu: 210.75 Tflops/s, 76.671 iter/s, 1.304e-02 s/iter, (0.126, 0.001, 0.052) sec
mfu: 163.981 Tflops/s, hfu: 204.976 Tflops/s, 74.570 iter/s, 1.341e-02 s/iter, (0.126, 0.001, 0.054) sec
da_config: SP=(2,8),Sg=(4096,4096),S=(65536,65536),Nh=(32,32),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, bwd
mfu: 64.011 Tflops/s, hfu: 80.013 Tflops/s, 7.277 iter/s, 1.374e-01 s/iter, (0.280, 0.002, 0.550) sec
# orchestrated_attn_func
mfu: 196.02 Tflops/s, hfu: 245.025 Tflops/s, 22.285 iter/s, 4.487e-02 s/iter, (0.195, 0.001, 0.179) sec
mfu: 196.202 Tflops/s, hfu: 245.252 Tflops/s, 22.306 iter/s, 4.483e-02 s/iter, (0.195, 0.001, 0.179) sec
da_config: SP=(2,8),Sg=(8192,8192),S=(131072,131072),Nh=(32,32),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, bwd
mfu: 111.878 Tflops/s, hfu: 139.847 Tflops/s, 3.180 iter/s, 3.145e-01 s/iter, (0.635, 0.001, 1.258) sec
# orchestrated_attn_func
mfu: 220.42 Tflops/s, hfu: 275.526 Tflops/s, 6.265 iter/s, 1.596e-01 s/iter, (0.425, 0.001, 0.638) sec
mfu: 216.699 Tflops/s, hfu: 270.874 Tflops/s, 6.159 iter/s, 1.624e-01 s/iter, (0.419, 0.001, 0.649) sec
da_config: SP=(2,8),Sg=(16384,16384),S=(262144,262144),Nh=(32,32),bs=1,D=128,causal=False,hierarchy=1:
YXs: [(1, 2), (2, 1)]
# ring_flash_attn_func, bwd
mfu: 146.068 Tflops/s, hfu: 182.585 Tflops/s, 1.038 iter/s, 9.635e-01 s/iter, (1.920, 0.003, 3.854) sec
# orchestrated_attn_func
mfu: 225.336 Tflops/s, hfu: 281.671 Tflops/s, 1.601 iter/s, 6.246e-01 s/iter, (1.380, 0.001, 2.498) sec
mfu: 224.62 Tflops/s, hfu: 280.775 Tflops/s, 1.596 iter/s, 6.266e-01 s/iter, (1.330, 0.001, 2.506) sec
+ set +x
